# ViT-STUMP
## Predicting relapse-free survival of gynecologic smooth muscle tumors of uncertain malignant potential using transformer-based model

**Abstract:** Smooth muscle tumors of uncertain malignant potential (STUMP) of the uterus have been one of the difficult diagnoses in gynecologic surgical pathology due to their uncertain morphological features. Conventional diagnostic strategies depend holistically on increased cytologic atypia, mitotic activity, and tumor cell/equivocal necrosis. However, assessing these factors can be time-consuming, labor-intensive, and subject to inter-observer variability among pathologists. In this study, we investigate a transformer-based model trained on digital Whole-Slide Images of histological tissue samples to predict the risk of relapse-free survival of STUMP patients in uterine cancer. The model was trained and validated on a cohort comprising 78 STUMP cases from several centers. The deep learning provided an average of C-index of 0.7504 over 5 folds cross-validation, the predicted risk scores successfully stratified patients into low-risk and high-risk groups of relapse with a high level of statistical significance. The predictions generated by the deep learning model were subsequently used as inputs for Cox regression, a statistical method for modeling survival data. This integration enhanced the performance of the Cox regression model, increasing its concordance index from 0.687 to 0.788 when compared to using only three pathological features. This analysis demonstrated that deep learning predictions derived from histopathological features can be served as a significant variable for predicting relapse-free survival. This proof of concept study demonstrates the potential of deep learning to improve STUMP diagnosis and prognostic processes, facilitating faster and more consistent treatment planning.

## Usage
The main program to train the model in cross-validation is implemented in 'main_clinical_cv.py'. In this file, we should take into account some parameters in order to train the model, for example: 'n_folds' - number of folds, 'npz_train' - the file path to the folder containing the features, 'npz-labels' - the csv file to the list of patients, etc.

The transformer-based model was implemented in 'transformer.py' and 'ViT.py'.

To test the pre-trained model, use the code in the 'inference_clinical_transformer_CV.py' or 'inference_clinical.py' files.
Please contact us to obtained the pretrained checkpoints.


## License
 This code is made available under the GPLv3 License and is available for non-commericial academic purposes.

## Contact
In order to obtain the checkpoint for testing the model. Please contact us at the email: 'van-linh.le@inria.fr'

